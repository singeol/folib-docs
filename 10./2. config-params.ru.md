# Подробное описание параметров конфигурации

## Переменные окружения

> Ниже перечислены поддерживаемые переменные окружения, их значения по умолчанию и краткое описание.

| Переменная | Значение по умолчанию | Описание |
|---|---|---|
| `FOLIB_HTTP_PORT` | — | HTTP‑порт |
| `FOLIB_SSL_ENABLED` | `false` | Включить SSL |
| `FOLIB_SSL_KEY_STORE` | — | Путь к хранилищу ключей SSL |
| `FOLIB_SSL_KEY_STORE_TYPE` | — | Тип хранилища ключей SSL |
| `FOLIB_SSL_KEY_STORE_PASSWORD` | — | Пароль хранилища ключей SSL |
| `FOLIB_SSL_KEY_ALIAS` | — | Алиас ключа SSL |
| `FOLIB_SSL_KEY_PASSWORD` | — | Пароль ключа SSL |
| `FOLIB_SSL_TRUST_STORE` | — | Путь к truststore SSL |
| `FOLIB_SSL_TRUST_STORE_PASSWORD` | — | Пароль truststore SSL |
| `FOLIB_SSL_TRUST_STORE_TYPE` | — | Тип truststore SSL |
| `FOLIB_ARTIFACT_DOWNLOAD_IMMEDIATELY_UPDATE` | `false` | Немедленно обновлять сведения об артефакте при скачивании |
| `FOLIB_DOCKER_BROWSE_COMPATIBILITY` | `false` | Совместимость режима «просмотра» Docker |
| `FOLIB_CLUSTER_OPENFLAG` | `false` | Включить кластерный режим |
| `FOLIB_DISTRIBUTED_LOCKIP` | `127.0.0.1` | Внутренний IP текущей машины (не VIP) для идентификации инстанса в кластере |
| `FOLIB_STORAGE_BASE_DIR` | `$FOLIB_DEFAULT_VAULT` | Базовый каталог хранения (если NAS вне VAULT — укажите иной путь) |
| `FOLIB_HOME` | `$FOLIB_DEFAULT_HOME` | Домашний каталог Folib |
| `FOLIB_VAULT` | `$FOLIB_DEFAULT_VAULT` | Каталог данных Folib |
| `FOLIB_PID_FILE` | `$FOLIB_VAULT/folib.pid` | Путь к PID‑файлу процесса |
| `FOLIB_JVM_XMX` | `4096m` | Максимальный heap JVM |
| `FOLIB_JVM_XMS` | `4096m` | Начальный heap JVM |
| `FOLIB_JVM_XSS` | `256k` | Размер стека потока JVM |
| `FOLIB_JVM_PARALLEL_GC_THREADS` | `8` | Число потоков Parallel GC |
| `FOLIB_JVM_MAX_DIRECT_MEMORY_SIZE` | `2048m` | Максимальный размер direct‑памяти JVM |
| `FOLIB_PORT` | `38080` | Порт запуска Folib |
| `FOLIB_DB_PROFILE` | `db_EMBEDDED` | Профиль БД |
| `FOLIB_GREMLIN_SERVER_ENABLED` | `false` | Включить Gremlin Server |
| `FOLIB_LOG_CONSOLE_ENABLED` | `false` | Логи в консоль |
| `FOLIB_LOG_FILE_ENABLED` | `true` | Логи в файл |
| `FOLIB_LOG_FILE_SIZE_SINGLE` | `128MB` | Максимальный размер одного лог‑файла |
| `FOLIB_LOG_FILE_SIZE_TOTAL` | `1GB` | Общий лимит размера логов |
| `FOLIB_LOG_FILE_HISTORY` | `31` | Срок хранения логов (дней) |
| `FOLIB_DEBUG` | `false` | Режим отладки |
| `FOLIB_NPM_REMOTE_CHANGES_ENABLED` | `false` | Разрешить удалённые изменения для NPM |
| `FOLIB_NUGET_DOWNLOAD_FEED` | `false` | Включить NuGet download feed |
| `FOLIB_DOWNLOAD_INDEXES` | `false` | Загружать индексы |
| `FOLIB_REMOTE_DB_HOST` | `127.0.0.1` | Хост удалённой БД |
| `FOLIB_REMOTE_DB_PORT` | `49142` | Порт удалённой БД |
| `FOLIB_REMOTE_DB_USER` | `root` | Пользователь удалённой БД |
| `FOLIB_REMOTE_DB_PASS` | `folib-cassandra` | Пароль удалённой БД |
| `FOLIB_EMBEDDED_DB_HOST` | `127.0.0.1` | Хост встроенной БД |
| `FOLIB_CASSANDRA_LISTEN_ADDRESS` | `127.0.0.1` | Адрес прослушивания Cassandra |
| `FOLIB_CASSANDRA_SEEDS` | `127.0.0.1` | Seed‑узлы Cassandra |
| `FOLIB_CLUSTER_NODE_TOTAL` | `3` | Общее число узлов кластера |
| `FOLIB_CASSANDRA_GC_GRACE_SECONDS` | `864000` | GC Grace Seconds для Cassandra |
| `FOLIB_JMX_PORT` | `7199` | Порт JMX |
| `FOLIB_S3_REGION` | `folib` | Регион S3 |
| `FOLIB_S3_URI` | `s3://localhost:9000/` | Адрес S3 |
| `FOLIB_S3_ACCESS_KEY` | `folib` | Access Key S3 |
| `FOLIB_S3_SECRET_KEY` | `folib` | Secret Key S3 |
| `FOLIB_ES_HOST` | `127.0.0.1` | Адрес сервера Elasticsearch |
| `FOLIB_PROMOTION_BLOCK` | `false` | Блокировать авто‑продвижение |
| `FOLIB_MYSQL_HOST` | `127.0.0.1` | Хост MySQL |
| `FOLIB_MYSQL_PORT` | `3306` | Порт MySQL |
| `FOLIB_MYSQL_DB` | `folib_scanner` | Имя БД MySQL |
| `FOLIB_MYSQL_USER` | `root` | Пользователь MySQL |
| `FOLIB_MYSQL_PASSWORD` | `199088926` | Пароль MySQL |
| `FOLIB_NVD` | `nvd.folib.com/feeds/json/cve/1.1` | Источник данных NVD |
| `FOLIB_REDIS_ENABLED` | `false` | Включить Redis |
| `FOLIB_REDIS_HOST` | `127.0.0.1` | Адрес Redis |
| `FOLIB_REDIS_PASSWORD` | `123456` | Пароль Redis |
| `FOLIB_WEB_URL_PREFIX` | `/ui/` | Префикс URL веб‑интерфейса |
| `FOLIB_CACHE_PORT` | `5701` | Порт кеша Hazelcast |
| `FOLIB_CACHE_CLUSTER` | `127.0.0.1:5701` | Адреса кластера Hazelcast |
| `FOLIB_SWAGGER_ENABLE` | `false` | Включить Swagger |
| `FOLIB_THREAD_POOL_COMMON_CORE` | `12` | Core‑потоки общего пула |
| `FOLIB_THREAD_POOL_COMMON_MAX` | `12` | Максимум потоков общего пула |
| `FOLIB_THREAD_POOL_COMMON_QUEUE` | `100000000` | Очередь общего пула |
| `FOLIB_THREAD_POOL_SCAN_CORE` | `2` | Core‑потоки пула сканирования |
| `FOLIB_THREAD_POOL_SCAN_MAX` | `2` | Максимум потоков пула сканирования |
| `FOLIB_THREAD_POOL_SCAN_QUEUE` | `12` | Очередь пула сканирования |
| `FOLIB_THREAD_POOL_EVENT_LOG_CORE` | `2` | Core‑потоки пула событий |
| `FOLIB_THREAD_POOL_EVENT_LOG_MAX` | `2` | Максимум потоков пула событий |
| `FOLIB_THREAD_POOL_EVENT_LOG_QUEUE` | `100` | Очередь пула событий |
| `FOLIB_THIRDPARTY_FOEYES_ENABLE` | `false` | Включить внешнюю интеграцию FoEyes |
| `FOLIB_THIRDPARTY_FOEYES_BASEURL` | `http://127.0.0.1:9527` | Базовый URL FoEyes |
| `FOLIB_THIRDPARTY_FOEYES_ACCESS_KEY` | `racdvMVzV9Wnqu8NAfQkyrsD0a2N0fNE` | Ключ доступа FoEyes |
| `FOLIB_THREAD_POOL_WORKER` | `6` | Рабочие потоки |
| `FOLIB_GREMLIN_POOL` | `6` | Размер пула Gremlin |
| `FOLIB_MAX_WORK_QUEUE_SIZE` | `16384` | Максимальный размер очереди работ |
| `FOLIB_MAX_SESSION_TASK_QUEUE_SIZE` | `8192` | Максимальный размер очереди задач сессии |
| `FOLIB_MAX_CONTENT_LENGTH` | `1048576` | Максимальная длина контента (байт) |
| `FOLIB_MAX_CHUNK_SIZE` | `65536` | Максимальный размер чанка (байт) |
| `FOLIB_MAX_ACCUMULATION_BUFFER_COMPONENTS` | `2048` | Макс. число компонентов буфера накопления |
| `FOLIB_RESULT_ITERATION_BATCH_SIZE` | `256` | Размер батча итерации результатов |
| `FOLIB_USE_EPOLL_EVENT_LOOP` | `true` | Использовать EPOLL event loop |
| `FOLIB_IDLE_CONNECTION_TIMEOUT` | `30000` | Таймаут простоя соединения (мс) |
| `FOLIB_EVALUATION_TIMEOUT` | `30000` | Таймаут вычисления (мс) |
| `FOLIB_WRITE_BUFFER_HIGH_WATER_MARK` | `65536` | High‑water mark write‑буфера (байт) |
| `FOLIB_WRITE_BUFFER_LOW_WATER_MARK` | `32768` | Low‑water mark write‑буфера (байт) |
| `FOLIB_ARTIFACT_UPLOAD_RESTRICTIONS` | `false` | Включить ограничения на загрузку артефактов |

## Как изменить параметры (VM)

**Шаг 1.** Откройте скрипт запуска для редактирования:

```bash
vim folib-1.0/bin/folib
```

**Шаг 2.** Отредактируйте нужные переменные в файле `folib` (пример ниже):

```bash
#!/usr/bin/env bash
## ----- выше опущено -----

# REMOTE: параметры Cassandra применяются только при профиле db_REMOTE
FOLIB_REMOTE_DB_HOST="${FOLIB_REMOTE_DB_HOST:-127.0.0.1}"
FOLIB_REMOTE_DB_PORT="${FOLIB_REMOTE_DB_PORT:-49142}"
FOLIB_REMOTE_DB_USER="${FOLIB_REMOTE_DB_USER:-root}"
FOLIB_REMOTE_DB_PASS="${FOLIB_REMOTE_DB_PASS:-folib-cassandra}"

# JMX
FOLIB_JMX_PORT="${FOLIB_JMX_PORT:-7199}"

# Если используется хранилище по протоколу S3 (по умолчанию — локальный NFS)
FOLIB_S3_REGION="${FOLIB_S3_REGION:-folib}"
FOLIB_S3_URI="${FOLIB_S3_URI:-s3://localhost:9000/}"
FOLIB_S3_ACCESS_KEY="${FOLIB_S3_ACCESS_KEY:-folib}"
FOLIB_S3_SECRET_KEY="${FOLIB_S3_SECRET_KEY:-folib}"

## Узел Elasticsearch для индексов графовой БД
FOLIB_ES_HOST="${FOLIB_ES_HOST:-10.50.8.55}"

## Настройки сканера
FOLIB_MYSQL_HOST="${FOLIB_MYSQL_HOST:-10.10.0.1}"  # адрес БД
FOLIB_MYSQL_PORT="${FOLIB_MYSQL_PORT:-3306}"        # порт БД
FOLIB_MYSQL_DB="${FOLIB_MYSQL_DB:-folib}"           # имя БД
FOLIB_MYSQL_USER="${FOLIB_MYSQL_USER:-root}"        # пользователь
FOLIB_MYSQL_PASSWORD="${FOLIB_MYSQL_PASSWORD:-password}"  # пароль
FOLIB_NVD="${FOLIB_NVD:-nvd.folib.com}"             # внутренний зеркальный источник NVD (если есть)

## ----- ниже опущено -----
```
